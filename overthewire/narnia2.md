# narnia2
```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
int main(int argc, char * argv[]){
    char buf[128];
    if(argc == 1){
        printf("Usage: %s argument\n", argv[0]);
        exit(1);
    }
    strcpy(buf,argv[1]);
    printf("%s", buf);
    return 0;
}
```
```gdb
(gdb) disas main
Dump of assembler code for function main:
   0x0804844b <+0>:     push   %ebp
   0x0804844c <+1>:     mov    %esp,%ebp
   0x0804844e <+3>:     add    $0xffffff80,%esp
   0x08048451 <+6>:     cmpl   $0x1,0x8(%ebp)
   0x08048455 <+10>:    jne    0x8048471 <main+38>
   0x08048457 <+12>:    mov    0xc(%ebp),%eax
   0x0804845a <+15>:    mov    (%eax),%eax
   0x0804845c <+17>:    push   %eax
   0x0804845d <+18>:    push   $0x8048520
   0x08048462 <+23>:    call   0x8048300 <printf@plt>
   0x08048467 <+28>:    add    $0x8,%esp
   0x0804846a <+31>:    push   $0x1
   0x0804846c <+33>:    call   0x8048320 <exit@plt>
   0x08048471 <+38>:    mov    0xc(%ebp),%eax
   0x08048474 <+41>:    add    $0x4,%eax
   0x08048477 <+44>:    mov    (%eax),%eax
   0x08048479 <+46>:    push   %eax
   0x0804847a <+47>:    lea    -0x80(%ebp),%eax
   0x0804847d <+50>:    push   %eax
   0x0804847e <+51>:    call   0x8048310 <strcpy@plt>
=> 0x08048483 <+56>:    add    $0x8,%esp
   0x08048486 <+59>:    lea    -0x80(%ebp),%eax
   0x08048489 <+62>:    push   %eax
   0x0804848a <+63>:    push   $0x8048534
   0x0804848f <+68>:    call   0x8048300 <printf@plt>
   0x08048494 <+73>:    add    $0x8,%esp
   0x08048497 <+76>:    mov    $0x0,%eax
   0x0804849c <+81>:    leave  
   0x0804849d <+82>:    ret    
   
(gdb) i r
eax            0xffffd5b8       -10824
ecx            0xffffd8a0       -10080
edx            0xffffd642       -10686
ebx            0x0      0
esp            0xffffd5b0       0xffffd5b0
ebp            0xffffd638       0xffffd638
esi            0x2      2
edi            0xf7fc5000       -134459392
eip            0x8048483        0x8048483 <main+56>
eflags         0x202    [ IF ]
cs             0x23     35
ss             0x2b     43
ds             0x2b     43
es             0x2b     43
fs             0x0      0
gs             0x63     99
(gdb) x/144bx $ebp-0x80
0xffffd5b8:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5c0:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5c8:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5d0:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5d8:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5e0:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5e8:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5f0:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd5f8:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd600:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd608:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd610:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd618:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd620:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd628:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd630:     0x41    0x41    0x41    0x41    0x41    0x41    0x41    0x41
0xffffd638:     0x42    0x42    0x42    0x42    0x42    0x42    0x42    0x42   # ebp = 0xffffd638
0xffffd640:     0x42    0x42    0x42    0x42    0x42    0x42    0x00    0xff
   
# Stack ================================================
# / buf [128]char / ebp_1 / return address /
# ======================================================
(gdb) x/200wx $ebp - 0x80
0xffffd5b8:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd5c8:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd5d8:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd5e8:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd5f8:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd608:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd618:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd628:     0x41414141      0x41414141      0x41414141      0x41414141
0xffffd638:     0x43434343      0xdeadbeef  # 0xdeadbeef at

(gdb) c
Continuing.
Program received signal SIGSEGV, Segmentation fault.
0xdeadbeef in ?? ()
